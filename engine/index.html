 <html>
 <head>
   
    <link type="text/css" rel="stylesheet" href="/stylesheets/main.css" />
    <script src='/_ah/channel/jsapi'></script>
    <script src='https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js'></script>
    <script type="text/javascript" src='/scripts/script.js'></script>
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
    <script type='text/javascript'>
    
      var state = {
        game_key: '{{ key }}'
      };
      
      var position = {};
      var map;
      
      sendMessage = function(path, opt_param, data) {
        path += '?g=' + state.game_key;
        if (opt_param) {
          path += '&' + opt_param;
        }
        var xhr = new XMLHttpRequest();
        xhr.open('POST', path, true);
        xhr.send(data);
      };

      onOpened = function() {
        sendMessage('/handshake',
          "latitude="+position.coords.latitude +
          "&longitude="+ position.coords.longitude);
      };

      onClose = function() {
        sendMessage('/closed');
      };
      
      openChannel = function() {
        var token = '{{ token }}';
        var channel = new goog.appengine.Channel(token);
        var handler = {
          'onopen': onOpened,
          'onmessage': onMessage,
          'onerror': function() {},
          'onclose': onClose
        };
        var socket = channel.open(handler);
        socket.onopen = onOpened;
        socket.onmessage = onMessage;
      }
      
      initialize = function() {
        navigator.geolocation.getCurrentPosition(function(pos){
          position = pos;
          var lat = position.coords.latitude; 
          var lng = position.coords.longitude
          var myLatlng = new google.maps.LatLng(lat, lng);
          var myOptions = {
            zoom: 13,
            center: myLatlng,
            mapTypeId: google.maps.MapTypeId.ROADMAP
          }
          map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
          openChannel();
        });
      }      
      
      onMessage = function(m) {
        $m = eval("("+m.data+")");
        if(!!$m.action){
          switch($m.action){
            case "display_users":
               displayUsers($m.users);
            break;          
          }
        }
      }

function displayUsers(users){
//  var users = eval("("+users+")");
  $('.users').empty();
  $(users).each(function(){
    $('.users').append('<h3>' + this.person + '</h3>'); 
    var userlatlon = new google.maps.LatLng(this.latitude,this.longitude);
    var marker = new google.maps.Marker({
      position: userlatlon,
      title:this.person
    });
    marker.setMap(map);
  });
}

$(document).ready(function(){
  initialize(); 
});
      
$(window).unload( function () { onClose(); } );

  </script>
  </head>
  <body>
    
    
    <div id="main">

<div class="top ui-helper-clearfix">
    <div class="header alpha20 ui-corner-all ui-helper-clearfix">
        <div class="floatLeft marginTop10 marginLeft10">Hello, Trinity Fraktul | <a href="/auth/authact=signout">log off</a></div>
        <div class="floatRight padding2">
            <div class="blueButton"><div>List Your Grid</div></div>
            <div class="blueButton"><div>Latest Grids</div></div>
        </div>
    </div>
    <div class="alpha60 greenBorder ui-corner-all marginTop10 ui-helper-clearfix">
        <div class="logoImage floatLeft"><img src="/images/hghub_logo.png"></div>
        <div class="container130 alpha20White ui-corner-all margin10">
            <div class="adBlock floatLeft"><a href="http://vdoba.eveny.net" target="blank">Want your own virtual space? Get your vdoba now!</a></div>
            <div class="adBlock floatLeft"><a href="http://vdoba.eveny.net" target="blank">Enterprise or Corporate? Don't miss out! Get into the 3rd dimension with Enterprise Hypergrid!</a></div>
            <div class="adBlock floatLeft"><a href="http://vdoba.eveny.net" target="blank">Private, Secure Virtual Events for classes, launches, conferences and more, with 3dVirtualEvents! </a></div>
        </div>    
    </div>
</div>
<div class="middle ui-corner-top alpha20 ui-helper-clearfix">
    <div class="middleContent ui-corner-all alpha20Grey floatLeft" style="width: 425px;">
        <ul>
            <li class="alpha20White ui-corner-all">    <div class="dividerLeft"></div>
<h3>asdfasdfasdf</h3><p>Etiam sit amet dui eu enim dictum molestie. Curabitur scelerisque, augue non volutpat fringilla, libero velit malesuada odio, ut mattis justo nulla eu leo. Curabitur ultrices odio vulputate est accumsan consequat. Donec a diam quam. In rhoncus viverra lacus, eu porttitor velit pharetra id. Phasellus convallis sem vel turpis malesuada commodo. </p></li>
            <li class="alpha20White ui-corner-all">    <div class="dividerLeft"></div>
<h3>asdfasdfasdf</h3><p>Etiam sit amet dui eu enim dictum molestie. Curabitur scelerisque, augue non volutpat fringilla, libero velit malesuada odio, ut mattis justo nulla eu leo. Curabitur ultrices odio vulputate est accumsan consequat. Donec a diam quam. In rhoncus viverra lacus, eu porttitor velit pharetra id. Phasellus convallis sem vel turpis malesuada commodo. </p></li>
            <li class="alpha20White ui-corner-all">    <div class="dividerLeft"></div>
<h3>asdfasdfasdf</h3><p>Etiam sit amet dui eu enim dictum molestie. Curabitur scelerisque, augue non volutpat fringilla, libero velit malesuada odio, ut mattis justo nulla eu leo. Curabitur ultrices odio vulputate est accumsan consequat. Donec a diam quam. In rhoncus viverra lacus, eu porttitor velit pharetra id. Phasellus convallis sem vel turpis malesuada commodo. </p></li>
            <li class="alpha20White ui-corner-all">    <div class="dividerLeft"></div>
<h3>asdfasdfasdf</h3><p>Etiam sit amet dui eu enim dictum molestie. Curabitur scelerisque, augue non volutpat fringilla, libero velit malesuada odio, ut mattis justo nulla eu leo. Curabitur ultrices odio vulputate est accumsan consequat. Donec a diam quam. In rhoncus viverra lacus, eu porttitor velit pharetra id. Phasellus convallis sem vel turpis malesuada commodo. </p></li>
            <li class="alpha20White ui-corner-all">    <div class="dividerLeft"></div>
<h3>asdfasdfasdf</h3><p>Etiam sit amet dui eu enim dictum molestie. Curabitur scelerisque, augue non volutpat fringilla, libero velit malesuada odio, ut mattis justo nulla eu leo. Curabitur ultrices odio vulputate est accumsan consequat. Donec a diam quam. In rhoncus viverra lacus, eu porttitor velit pharetra id. Phasellus convallis sem vel turpis malesuada commodo. </p></li>
            <li><h3>asdfasdfasdf</h3><p>Etiam sit amet dui eu enim dictum molestie. Curabitur scelerisque, augue non volutpat fringilla, libero velit malesuada odio, ut mattis justo nulla eu leo. Curabitur ultrices odio vulputate est accumsan consequat. Donec a diam quam. In rhoncus viverra lacus, eu porttitor velit pharetra id. Phasellus convallis sem vel turpis malesuada commodo. </p></li>
            <li><h3>asdfasdfasdf</h3><p>Etiam sit amet dui eu enim dictum molestie. Curabitur scelerisque, augue non volutpat fringilla, libero velit malesuada odio, ut mattis justo nulla eu leo. Curabitur ultrices odio vulputate est accumsan consequat. Donec a diam quam. In rhoncus viverra lacus, eu porttitor velit pharetra id. Phasellus convallis sem vel turpis malesuada commodo. </p></li>
            <li><h3>asdfasdfasdf</h3><p>Etiam sit amet dui eu enim dictum molestie. Curabitur scelerisque, augue non volutpat fringilla, libero velit malesuada odio, ut mattis justo nulla eu leo. Curabitur ultrices odio vulputate est accumsan consequat. Donec a diam quam. In rhoncus viverra lacus, eu porttitor velit pharetra id. Phasellus convallis sem vel turpis malesuada commodo. </p></li>
            <li><h3>asdfasdfasdf</h3><p>Etiam sit amet dui eu enim dictum molestie. Curabitur scelerisque, augue non volutpat fringilla, libero velit malesuada odio, ut mattis justo nulla eu leo. Curabitur ultrices odio vulputate est accumsan consequat. Donec a diam quam. In rhoncus viverra lacus, eu porttitor velit pharetra id. Phasellus convallis sem vel turpis malesuada commodo. </p></li>
            <li><h3>asdfasdfasdf</h3><p>Etiam sit amet dui eu enim dictum molestie. Curabitur scelerisque, augue non volutpat fringilla, libero velit malesuada odio, ut mattis justo nulla eu leo. Curabitur ultrices odio vulputate est accumsan consequat. Donec a diam quam. In rhoncus viverra lacus, eu porttitor velit pharetra id. Phasellus convallis sem vel turpis malesuada commodo. </p></li>
            <li><h3>asdfasdfasdf</h3><p>Etiam sit amet dui eu enim dictum molestie. Curabitur scelerisque, augue non volutpat fringilla, libero velit malesuada odio, ut mattis justo nulla eu leo. Curabitur ultrices odio vulputate est accumsan consequat. Donec a diam quam. In rhoncus viverra lacus, eu porttitor velit pharetra id. Phasellus convallis sem vel turpis malesuada commodo. </p></li>
            <li><h3>asdfasdfasdf</h3><p>Etiam sit amet dui eu enim dictum molestie. Curabitur scelerisque, augue non volutpat fringilla, libero velit malesuada odio, ut mattis justo nulla eu leo. Curabitur ultrices odio vulputate est accumsan consequat. Donec a diam quam. In rhoncus viverra lacus, eu porttitor velit pharetra id. Phasellus convallis sem vel turpis malesuada commodo. </p></li>
            <li><h3>asdfasdfasdf</h3><p>Etiam sit amet dui eu enim dictum molestie. Curabitur scelerisque, augue non volutpat fringilla, libero velit malesuada odio, ut mattis justo nulla eu leo. Curabitur ultrices odio vulputate est accumsan consequat. Donec a diam quam. In rhoncus viverra lacus, eu porttitor velit pharetra id. Phasellus convallis sem vel turpis malesuada commodo. </p></li>
        </ul>
    </div>
    <div class="middleContent ui-corner-all alpha20Grey floatRight"><h3>
    <div id="map_canvas"></div>
    <div class="users"></div>
    {%for docs in documents.entry%}
      
    {{docs.title.text}}<br />

    {%endfor%}
        
    {{nickname}} <a href="{{ url }}">{{ url_linktext }}</a>

      
    </h3></div>
</div>
<div class="footer ui-corner-all alpha60 greenBorder ui-helper-clearfix marginTop10">
    <div class="margin10" style="text-align: right;"><a href="javascript:" class="contact">contact at eveny dot net</a> | <a href="javascript:" class="support">support at eveny dot net</a> | 805-24EVENY</div>
    <div class="dividerRight"></div>
    <div class="dividerLeft"></div>
    <div class="margin10">
        <a href="http://www.vdoba.com">vdoba - virtual space for real people</a> <br> 
        <a href="http://www.enterprisehypergrid.com">hypergrid solutions for enterprise</a> <br>
        <a href="http://www.virtual3devents.com">3d virtual events for collaboration, launch events, conferences and more</a><br> 
        <a href="http://www.evenyvirtual.com">eveny virtual solutions</a> 
    </div>
    <div class="dividerLeft"></div>
    <div class="dividerRight"></div>
    <div class="margin10" style="text-align: right;">
        <a href="http://www.vdoba.com">privacy policy</a> | 
        <a href="http://www.enterprisehypergrid.com">eveny, rhymes with spaghetti... kinda</a>
    </div>
</div>

</div>

<!-- end recieve /public/sites/hghub/content -->



</div>
    

  </body>
</html>